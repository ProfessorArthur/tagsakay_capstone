name = "tagsakay-api"
main = "src/index.ts"
compatibility_date = "2024-01-01"

# Environment variables (add these via Wrangler CLI or dashboard)
# wrangler secret put DATABASE_URL
# wrangler secret put JWT_SECRET

[env.production]
name = "tagsakay-api-production"
routes = [
  { pattern = "api.tagsakay.com/*", custom_domain = true }
]

[env.development]
name = "tagsakay-api-development"
# Development uses .dev.vars and runs locally on port 8787

[env.staging]
name = "tagsakay-api-staging"

# Durable Objects for WebSocket connections
[[durable_objects.bindings]]
name = "DEVICE_CONNECTIONS"
class_name = "DeviceConnection"
script_name = "tagsakay-api"

[[migrations]]
tag = "v1"
new_classes = ["DeviceConnection"]

# Bindings (if using D1, KV, R2, etc. - optional)
# [[d1_databases]]
# binding = "DB"
# database_name = "tagsakay"
# database_id = "xxx"
